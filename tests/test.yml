---
- hosts: all
  remote_user: root
  become: yes
  become_method: sudo
  gather_facts: yes
  # tasks:
  #   - name: test
  #     debug: msg="{{ ansible_user_id }} - {{ ansible_ssh_user }} - {{ inventory_hostname }} - {{ ansible_hostname }} - {{ inventory_hostname_short }}"

  pre_tasks:
    - name: test
      debug: msg="{{ ansible_user_id }} - {{ ansible_ssh_user }} - {{ inventory_hostname }} - {{ ansible_hostname }} - {{ inventory_hostname_short }}"

    - name: Rsync files
      synchronize:
        src: ../files/test/rebuild/
        dest: /tmp/nginx
        rsync_opts: '--no-owner --no-group'
      when: inventory_hostname == "localhost"
  roles:
    - ansible-role-nginx
